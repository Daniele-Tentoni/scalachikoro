language: scala

install: true

cache:
  directories:
    - $HOME/.ivy2/cache
    - /tmp/texlive
    - $HOME/.texlive
    - $HOME/.cache/coursier
    - $HOME/.sbt

jobs:
  include:
    # Build with Linux systems.
    - stage: Run sbt on Linux
      os: linux
      dist: trusty
      scala:
        - 2.10.7
      jdk:
        - openjdk11
    - os: linux
      dist: trusty
      scala:
        - 2.12.12
      jdk:
        - openjdk11
    - os: linux
      dist: trusty
      scala:
        - 2.10.3
      jdk:
        - openjdk14
    - os: linux
      dist: trusty
      scala:
        - 2.12.12
      jdk:
        - openjdk14
    - os: linux
      dist: xenial
      scala:
        - 2.10.7
      jdk:
        - openjdk11
    - os: linux
      dist: xenial
      scala:
        - 2.12.12
      jdk:
        - openjdk11
    - os: linux
      dist: xenial
      scala:
        - 2.10.7
      jdk:
        - openjdk14
    - os: linux
      dist: xenial
      scala:
        - 2.12.12
      jdk:
        - openjdk14
    # Build with MacOs systems.
    - stage: Run sbt on Mac
      os: osx
      osx_image:
        - xcode12
      scala:
        - 2.10.7
      jdk:
        - openjdk14
    - os: osx
      osx_image:
        - xcode12
      scala:
        - 2.10.7
      jdk:
        - openjdk11
    - os: osx
      osx_image:
        - xcode12
      scala:
        - 2.12.12
      jdk:
        - openjdk14
    - os: osx
      osx_image:
        - xcode12
      scala:
        - 2.12.12
      jdk:
        - openjdk11
    - os: osx
      osx_image:
        - xcode11
      scala:
        - 2.10.7
      jdk:
        - openjdk14
    - os: osx
      osx_image:
        - xcode11
      scala:
        - 2.10.7
      jdk:
        - openjdk11
    - os: osx
      osx_image:
        - xcode11
      scala:
        - 2.12.12
      jdk:
        - openjdk14
    - os: osx
      osx_image:
        - xcode11
      scala:
        - 2.12.12
      jdk:
        - openjdk11
    # Send test statistics to other services.
    - stage: Test coverage reports
      scala:
        - 2.12.12
      jdk: openjdk11
      os: linux
      dist: xenial
      script:
        - sbt coverage test coverageReport coverageAggregate
        - bash <(curl -s https://codecov.io/bash)
        # - bash <(curl -Ls https://coverage.codacy.com/get.sh) report -r ./target/scala-2.12/coverage-report/coberatura.xml
